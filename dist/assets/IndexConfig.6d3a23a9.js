import"./vendor.3b4a458a.js";/* empty css             *//* empty css               *//* empty css              */import{r as e,g as o,o as r,c as a,w as l,a as t,f as n,q as i,K as d,s,h as u,i as c,l as p,j as m,L as f,_ as g,x as b,v as y,d as h,M as _,N as v,O as k,P as x,E as F,m as T,Q as C,R as w,J as V,S as j,T as S,p as I,b as U}from"./index.5a9a60f4.js";/* empty css                  *//* empty css                     *//* empty css                 *//* empty css                   *//* empty css                *//* empty css                  */const P={class:"dialog-footer"},N={__name:"DialogAddGood",props:{type:String,configType:Number,reload:Function},setup(g,{expose:b}){const y=g,h=e(null),_=o({visible:!1,ruleForm:{name:"",link:"",id:"",sort:""},rules:{name:[{required:"true",message:"名称不能为空",trigger:["change"]}],id:[{required:"true",message:"编号不能为空",trigger:["change"]}],sort:[{required:"true",message:"排序不能为空",trigger:["change"]}]},id:""}),v=()=>{h.value.validate((e=>{if(e){if(_.ruleForm.id<0||_.ruleForm.id>200)return void d.error("商品编号不能小于 0 或大于 200");"add"==y.type?s.post("/indexConfigs",{configType:y.configType||3,configName:_.ruleForm.name,redirectUrl:_.ruleForm.link,goodsId:_.ruleForm.id,configRank:_.ruleForm.sort}).then((()=>{d.success("添加成功"),_.visible=!1,y.reload&&y.reload()})):s.put("/indexConfigs",{configId:_.id,configType:y.configType||3,configName:_.ruleForm.name,redirectUrl:_.ruleForm.link,goodsId:_.ruleForm.id,configRank:_.ruleForm.sort}).then((()=>{d.success("修改成功"),_.visible=!1,y.reload&&y.reload()}))}}))};return b({open:e=>{_.visible=!0,e?(_.id=e,(e=>{s.get(`/indexConfigs/${e}`).then((e=>{_.ruleForm={name:e.configName,id:e.goodsId,link:e.redirectUrl,sort:e.configRank}}))})(e)):_.ruleForm={name:"",id:"",link:"",sort:""}},close:()=>{_.visible=!1}}),(e,o)=>{const d=u,s=c,b=p,y=m,k=f;return r(),a(k,{title:"add"==g.type?"添加商品":"修改商品",modelValue:_.visible,"onUpdate:modelValue":o[5]||(o[5]=e=>_.visible=e),width:"400px"},{footer:l((()=>[t("span",P,[n(y,{onClick:o[4]||(o[4]=e=>_.visible=!1)},{default:l((()=>[i("取 消")])),_:1}),n(y,{type:"primary",onClick:v},{default:l((()=>[i("确 定")])),_:1})])])),default:l((()=>[n(b,{model:_.ruleForm,rules:_.rules,ref_key:"formRef",ref:h,"label-width":"100px",class:"good-form"},{default:l((()=>[n(s,{label:"商品名称",prop:"name"},{default:l((()=>[n(d,{type:"text",modelValue:_.ruleForm.name,"onUpdate:modelValue":o[0]||(o[0]=e=>_.ruleForm.name=e)},null,8,["modelValue"])])),_:1}),n(s,{label:"跳转链接",prop:"link"},{default:l((()=>[n(d,{type:"text",modelValue:_.ruleForm.link,"onUpdate:modelValue":o[1]||(o[1]=e=>_.ruleForm.link=e)},null,8,["modelValue"])])),_:1}),n(s,{label:"商品编号",prop:"id"},{default:l((()=>[n(d,{type:"number",min:"0",modelValue:_.ruleForm.id,"onUpdate:modelValue":o[2]||(o[2]=e=>_.ruleForm.id=e)},null,8,["modelValue"])])),_:1}),n(s,{label:"排序值",prop:"sort"},{default:l((()=>[n(d,{type:"number",modelValue:_.ruleForm.sort,"onUpdate:modelValue":o[3]||(o[3]=e=>_.ruleForm.sort=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}}};const z={class:"header"},R=["href"],q=["onClick"],B=(e=>(I("data-v-0790635e"),e=e(),U(),e))((()=>t("a",{style:{cursor:"pointer"}},"删除",-1)));var D=g({__name:"IndexConfig",setup(a){const u={hot:3,new:4,recommend:5},c=b(),p=y(),f=e(null),g=e(null),I=o({loading:!1,tableData:[],multipleSelection:[],total:0,currentPage:1,pageSize:10,type:"add",configType:3});c.beforeEach((e=>{["hot","new","recommend"].includes(e.name)&&(I.configType=u[e.name],I.currentPage=1,U())})),h((()=>{I.configType=u[p.name],U()}));const U=()=>{I.loading=!0,s.get("/indexConfigs",{params:{pageNumber:I.currentPage,pageSize:I.pageSize,configType:I.configType}}).then((e=>{I.tableData=e.list,I.total=e.totalCount,I.currentPage=e.currPage,I.loading=!1}))},P=()=>{I.type="add",g.value.open()},D=e=>{I.multipleSelection=e},E=()=>{I.multipleSelection.length?s.delete("/indexConfigs",{ids:I.multipleSelection.map((e=>e.configId))}).then((()=>{d.success("删除成功"),U()})):d.error("请选择项")},G=e=>{I.currentPage=e,U()};return(e,o)=>{const a=m,u=_,c=v,p=k,b=x,y=F;return r(),T(C,null,[n(y,{class:"index-container"},{header:l((()=>[t("div",z,[n(a,{type:"primary",icon:w(j),onClick:P},{default:l((()=>[i("增加")])),_:1},8,["icon"]),n(u,{title:"确定删除吗？",confirmButtonText:"确定",cancelButtonText:"取消",onConfirm:E},{reference:l((()=>[n(a,{type:"danger",icon:w(S)},{default:l((()=>[i("批量删除")])),_:1},8,["icon"])])),_:1})])])),default:l((()=>[n(p,{load:I.loading,ref_key:"multipleTable",ref:f,data:I.tableData,"tooltip-effect":"dark",style:{width:"100%"},onSelectionChange:D},{default:l((()=>[n(c,{type:"selection",width:"55"}),n(c,{prop:"configName",label:"商品名称"}),n(c,{label:"跳转链接"},{default:l((e=>[t("a",{target:"_blank",href:e.row.redirectUrl},V(e.row.redirectUrl),9,R)])),_:1}),n(c,{prop:"configRank",label:"排序值",width:"120"}),n(c,{prop:"goodsId",label:"商品编号",width:"200"}),n(c,{prop:"createTime",label:"添加时间",width:"200"}),n(c,{label:"操作",width:"100"},{default:l((e=>[t("a",{style:{cursor:"pointer","margin-right":"10px"},onClick:o=>{return r=e.row.configId,I.type="edit",void g.value.open(r);var r}},"修改",8,q),n(u,{title:"确定删除吗？",confirmButtonText:"确定",cancelButtonText:"取消",onConfirm:o=>{return r=e.row.configId,void s.delete("/indexConfigs",{ids:[r]}).then((()=>{d.success("删除成功"),U()}));var r}},{reference:l((()=>[B])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["load","data"]),n(b,{background:"",layout:"prev, pager, next",total:I.total,"page-size":I.pageSize,"current-page":I.currentPage,onCurrentChange:G},null,8,["total","page-size","current-page"])])),_:1}),n(N,{ref_key:"addGood",ref:g,reload:U,type:I.type,configType:I.configType},null,8,["type","configType"])],64)}}},[["__scopeId","data-v-0790635e"]]);export{D as default};
